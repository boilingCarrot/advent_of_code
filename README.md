All done in pure C17, standard libraries only
